version: 2

models:
  - name: stg_salesforce__opportunities
    description: "Staged Salesforce opportunities, excluding deleted records"
    columns:
      - name: opportunity_id
        tests:
          - not_null
          - unique
      - name: amount
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              config:
                where: "is_won = true"
      - name: stage
        tests:
          - not_null

  - name: stg_salesforce__accounts
    description: "Staged Salesforce accounts (company records)"
    columns:
      - name: sf_account_id
        tests:
          - not_null
          - unique
